@page "/photodetail/{PhotoId}"
@using PhotoBank.Dto.View
@inherits PhotoDetailBase

@functions {
}
<style type="text/css">
    .wrapper {
        position: relative;
    }

    .box {
        position: absolute;
        top: 10px;
        border: 1px solid white;
        background-color: transparent;
        display: flex;
    }

        .box span {
            -webkit-align-self: flex-end;
            -o-align-self: flex-end;
            align-self: flex-end;
            color: white;
            font-size: smaller;
        }
</style>
@if (Photo == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <span>Name:</span>
    @Photo.Name<br>
    <span>Caption:</span>
    @foreach (var caption in Photo.Captions)
    {
        @caption<br>
    }
    <span>Tags:</span>
    @foreach (var tag in Photo.Tags)
    {
        @tag<br>
    }

    @foreach (var face in Photo.Faces)
    {
        <select value="@face.PersonId" @onchange="@OnChangePerson(face)">
            @if (Persons != null)
            {
                @foreach (var person in Persons)
                {
                    <option value="@person.Id">@person.Name</option>
                }
            }
        </select>
    }

    <div class="wrapper">
        <img src="data:image;base64,@Convert.ToBase64String(Photo.PreviewImage)" alt="" />
        @foreach (var face in Photo.Faces)
        {
            <div class="box" style="top: @face.FaceBox.Top; left: @face.FaceBox.Left; width: @face.FaceBox.Width; height: @face.FaceBox.Height">
                <span>@GetPersonNameById(face.PersonId)</span>
            </div>
        }
    </div>
}